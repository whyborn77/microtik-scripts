# Name: DHCPServer-script-DHCPAlert v711.1
# Description: Notify to email if DHCP Alert Discovered unknown dhcp-server. Just add to IP -> DHCP Server -> DHCP (tab) -> DHCP server instance -> Script (tab) -> Lease Script 
# Author: Whyborn77 2023
# License: GPL-3.0 License
# URL: https://github.com/whyborn77/microtik-scripts
:local DevName [/system identity get name];

/tool e-mail send from="<SET EMAIL HERE>" server=<SET SMTP HERE> to=<SET EMAIL TO HERE> subject/tool e-mail send from="device@ermolenko.su" server=smtp.yandex.ru to=report@ermolenko.su subject=("DHCP Alert: Discovered unknown dhcp-server, RouterBoard identity: ".[/system identity get name]) body="MikroTik have been detected unknown dhcp-server: \n\nIP: $address \nInterface: $interface \nMAC: $mac-address";
;log info "e-mail send unknown dhcp-server"
;log error ("DHCP found on PORT:".($"portname")."   MAC:".($"mac-address")."   IP:".($address))
